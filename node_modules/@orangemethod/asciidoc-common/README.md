# ASCIIDOC-COMMON

This project contains common scripts, dependencies and assets (such as images) used throughout our AsciiDoc curriculum.

Soon this project will be used by the [OM Lesson Yeoman Generator](https://github.homedepot.com/OM-Instructors/generator-om-lesson).

## Usage
The project is published to our [THD artifactory](registry=https://npm.artifactory.homedepot.com/artifactory/api/npm/npm/) as `@orangemethod/asciidoc-common` and thus can be used in a lesson by including the following dependency in a package.json file:

```json
"dependencies": {
    "@orangemethod/asciidoc-common": "^1.0.0"
}
```

You will also need to have a `.npmrc` file either in your `$HOME` directory or in the project directory (the directory that contains the `package.json` file). The contents of the `.npmrc` file should be:

```
registry=https://npm.artifactory.homedepot.com/artifactory/api/npm/npm/
strict-ssl=false
```

## Pygments Themes

We use `pygments` for code block syntax highlighting.

This project has a `vars.adoc` file that sets the pygments theme to `monokai`. If `monokai` doesn't work for your content (i.e. React JSX files look bad with `monokai` because there are no known pygments lexers for `JSX`), then you can override the setting in your `adoc` files by setting the pygments style *after* the include of the `vars.adoc` file:

.mylesson.adoc
```
include::../node_modules/@orangemethod/asciidoc-common/vars.adoc[]
:pygments-style: default
```

You can see a list of available themes by running the following shell command:

```bash
$(dirname $(gem which pygments.rb))/../vendor/pygments-main/pygmentize -L styles
```


## Deploying

To deploy this project to the [THD artifactory](registry=https://npm.artifactory.homedepot.com/artifactory/api/npm/npm/), simply run the following command:

```bash
# login to artifactory
# when prompted, supply your LDAP credentials and your Home Depot email address
yarn login  # equivalent to npm adduser

# yarn publish is better than npm publish as it:
#   - prompts for the new version
#   - bumps the version in the package.json file
#   - git commits the new version
#   - adds a git tag with the new version
#   - provides better logging
# Note that this will fail if you try to publish a version that has already been published.
yarn publish

# Don't forget to push the latest commit:
git push


# You can see info about the published artifact with:

yarn info @orangemethod/asciidoc-common
```

You can read more about publish artifacts at [Yarn: publishing a package](https://yarnpkg.com/en/docs/publishing-a-package).
